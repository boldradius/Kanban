<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    
    <!-- JQuery -->
    <script src="scripts/jquery.min.js"></script>
    <!-- JQuery UI -->
    <script src="Scripts/jquery-ui-1.11.0/jquery-ui.min.js"></script>

    <!-- Twitter Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link href="styles/bootstrap.min.css" rel="stylesheet" />
    <!-- Latest compiled and minified JavaScript -->
    <script src="scripts/bootstrap.min.js"></script>
    
    <!-- Knockout JS -->
    <script src="scripts/knockout-3.1.0.js"></script>
    
    <!-- Custom Styles -->
    <link href="styles/column-sizes.css" rel="stylesheet" />
    <link href="styles/CustomStyles.css" rel="stylesheet" />
    

    <title></title>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="page-header"><h1 class="col-md-offset-1" data-bind="text: 'BoldRadius Kanban'"></h1></div>
        </div>
        <div class="row panel-heading">
            <div class="col-md-2 text-center"><span>Project</span><div data-bind="click: $root.addProjectClicked" class="col-md-2"><span class="addLink">+Add Project</span></div></div>
            <div class="container col-md-10">
                <!-- ko foreach: board.statuses -->
                <div class="col-md-4 text-center">
                    <span data-bind="text:name"></span>
                </div>
                <!-- /ko -->
            </div>
        </div>
        <div data-bind="foreach: board.projects">
            <div class="row project">
                <div class="col-md-2"><span style="float:right" data-bind="text:name"></span></div>
                <div class="container container-lg-height col-md-10">
                    <!-- ko foreach: statuses -->
                    <div class="status sortable-status col-lg-height col-top col-md-4" data-bind="attr: { 'status-id' : id }">
                        <!-- ko foreach: tasks -->
                        <div data-bind="attr: { 'task-id' : id }, click: function() {$root.editTask($data, $parents[0], $parents[1]);}" class="col-md-offset-1 col-md-5 well well-sm task">
                            <span data-bind="text:name"></span><br />
                            <span data-bind="text:description" class="small"></span>
                        </div>
                        <!-- /ko -->
                        <div data-bind="click: function() {$root.addTask($data, $parents[0]);}" class="col-md-offset-1 col-md-5"><span class="addLink">+Add Task</span></div>
                    </div>
                    <!-- /ko -->
                </div>
            </div>
        </div>
    </div>
    
    
    <div class="modal fade" id="taskModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title col-md-offset-1">Task</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group-lg">
                        <label for="taskName">Name</label>
                        <input id="taskName" class="form-control" type="text" placeholder="Name" data-bind="value: taskForModal.name" />
                    </div>
                    <div class="form-group-lg">
                        <label for="description">Description</label>
                        <input id="description" class="form-control" type="text" placeholder="Description" data-bind="value: taskForModal.description" />
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-bind="click: doneAddTask">Done</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
    
    
    <div class="modal fade" id="projectModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title col-md-offset-1">Project</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group-lg">
                        <label for="projectName">Name</label>
                        <input id="projectName" class="form-control" type="text" placeholder="Name" data-bind="value: projectForModal.name" />
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-bind="click: doneAddProject">Done</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
    

    <script src="scripts/kanbanviewmodel.js"></script>
    <script src="scripts/model.js"></script>
    <script>


        var board = {};
        board.statuses =
        [
            { id: 1, name: "Ready" },
            { id: 2, name: "Doing" },
            { id: 3, name: "Done" }
        ];

        board.projects = [];
        var project1 = BoldRadiusKanban.Model.Project("Ideas & Solution");
        var statusReady = BoldRadiusKanban.Model.Status("Ready");
        var statusDoing = BoldRadiusKanban.Model.Status("Doing");
        var statusDone = BoldRadiusKanban.Model.Status("Done");
        var task1 = BoldRadiusKanban.Model.Task("Create DB tables", "Use EF to generate Code First database", project1.id, 1);
        var task2 = BoldRadiusKanban.Model.Task("Integration tests", "Create some system-wide integration tests", project1.id, 1);
        statusReady.tasks.push(task1);
        statusReady.tasks.push(task2);
        project1.statuses.push(statusReady);
        project1.statuses.push(statusDoing);
        project1.statuses.push(statusDone);
        board.projects.push(project1);
        
        var project2 = BoldRadiusKanban.Model.Project("BoldRadius Kanban Board");
        var status2Ready = BoldRadiusKanban.Model.Status("Ready");
        var status2Doing = BoldRadiusKanban.Model.Status("Doing");
        var task3 = BoldRadiusKanban.Model.Task("Create client-side solution", "Make sure you can open source this code", project2.id, 1);
        var status2Done = BoldRadiusKanban.Model.Status("Done");
        status2Ready.tasks.push(task3);
        project2.statuses.push(status2Ready);
        project2.statuses.push(status2Doing);
        project2.statuses.push(status2Done);
        board.projects.push(project2);

        var viewModel = new KanbanViewModel(board);

        ko.applyBindings(viewModel);

        $(function () {
            $(".sortable-status").sortable({
                connectWith: ".sortable-status",
                receive: function (event, ui) {
                    viewModel.updateStatus(ui.item.attr("task-id"), ui.item.parent().attr("status-id"));
                }
            });
            $(".sortable-status").disableSelection();
        });
    </script>

</body>
</html>